---
title: Settings
description: การปรับแต่ง Dev Containers
toc: true
authors: []
featuredImage: docs/vscode/devcontainer/docker-vscode.jpg
date: 2023-04-27T02:55:21+07:00
lastmod: 2023-04-27T02:55:21+07:00
tags: [docker, devcontainer, vscode]
draft: false
weight: 3
---

จากตอนที่แล้วเราจะเห็นว่าหากมีการ rebuild ใหม่ค่าต่าง ๆ จะหายไป extensions ที่ติดตั้งไว้ก็หายไปด้วย ดังนั้นสิ่งจำเป็นอย่างมากในการใช้งาน Dev Containers คือตั้งค่าต่าง ๆ ไว้เมื่อมีการ build ใหม่แต่ละครั้งก็จะกลับมาเหมือนเดิมทุกอย่างพร้อมที่ใช้งาน และ เขียน code ต่อได้เลย โดยค่าที่จำเป็นเบื้องต้นที่จะแนะนำวันนี้มีดังนี้

## devcontainer.json

พระเอกของเรายังคงเป็น file `devcontainer.json` เหมือนเดิมโดยการตั้งแบบละเอียดท่านสามารถไปศึกษาต่อได้ที่ [Dev Container metadata reference](https://containers.dev/implementors/json_reference/)

ในตอนนี้ขอกล่าวสัก 2 - 3 property แค่เป็นแนวทางนะครับ

### name

เราเจอจากตอนที่แล้วสำหรับการตั้งค่า name ซึ่งเป็นการตั้งชื่อ Dev Container ของเรานั่นเองเมื่อ start ขึ้นมาจะปรากฎอยู่บน title bar ของ VSCode และ ในเมนู `File` -->  `Open Recent` ซึ่งสำคัญพอสมควรเมื่อเราต้องการเปิด Project นี้เมื่อปิดไปแล้วมันจะปรากฎชื่อที่เราตั้งนี้ให้สังเกตได้ง่ายนั่นเอง

### image

เป็นการระบุ docker image ที่จะใช้ในการ build Dev Container ที่จะใช้งาน image ตรงนี้เราสามารถ build ไว้ใช้เองก็ได้นะครับ แล้ว push ไปไว้ยัง registry หรือ จะ build แบบกำหนดเองด้วย Dockerfile ก็ได้ผมจะเขียนในตอนต่อ ๆ ไปอีกครั้งครับ

### init 

บาง service จะมีปัญหาเรื่องการจัดการ process ทำให้เกิด zombie ระหว่างทำงานบางอย่างดังนั้นการใส่ init เป็น true จะช่วยเรื่องนี้ได้ แนะนำว่าให้ใส่ไปทุกครั้งก็ได้ เพราะไม่มีผลอะไร จากประสบการณ์ส่วนตัวเวลาเรา dev แล้วเกิด zombie นี่ต้อง rebuild ใหม่อย่างเดียวเลยบางทีทำให้ docker deamon รวนและตายไปด้วย

### customizations

`customizations` นี่ถือเป็นส่วนที่ต้องตั้งค่าเยอะสุดละเพราะการกำหนดค่าของ vscode จะตั้งในส่วนนี้ นั่นหมายความว่าเราอยากให้ vscode เป็นอย่างไรเราก็เอา settings ของ vscode มาใส่ไว้ที่นี่ได้เลยเมื่อ build container ขึ้นมาก็จะเหมือนเดิมทุกครั้ง และ ที่สำคัญคือในทีมจะได้หน้าตา vscode ที่เหมือนกันมีเครื่องมือที่เหมือนกันปัญหาเรื่องกำหนด format บางอย่างก็จะหมดไปเพราะทุกคนมีเครื่องมือที่เหมือนกันนั่นเอง

### postCreateCommand

สำหรับบาง project ไม่ได้ใหญ่มาก ไม่ต้องติดตั้งอะไรมากสามรถใช้คำสั่งนี้ติดตั้งส่วนต่าง ๆ เพิ่มหลังจาก container ถูกสร้างเสร็จแล้ว เช่น การติดตั้ง package การใช้ pip หรือ npm เป็นต้น ถ้ามีหลายคำสั่งเราสามารถสร้างเป็น shell script แล้วเรียกก็ได้

### features

บางครั้งเราต้องการติดตั้งเครื่องมือบางอย่างเพิ่มเติม เช่น shell พวก fish, hugo, pnpm หรืออื่น ๆ ที่มี scripts เตรียมไว้ให้ซึ่งสามารถดูได้จาก [Dev Containers Features](https://containers.dev/features)