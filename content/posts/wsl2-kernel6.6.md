---
title: "‡∏Å‡∏≤‡∏£ Compile Kernel 6.6 LTS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö WSL2"
description: ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å WSL2 ‡πÑ‡∏î‡πâ‡∏õ‡∏•‡πà‡∏≠‡∏¢ kernel ‡πÉ‡∏´‡∏°‡πà ‡∏£‡∏∏‡πà‡∏ô 6.6 lts  ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß update ‡∏´‡∏•‡∏±‡∏Å‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á build kernel ‡πÄ‡∏≠‡∏á‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
date: 2024-07-05T11:17:33+07:00
featuredImage: posts/wsl2/system-info.png
draft: false
---

‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å WSL2 ‡πÑ‡∏î‡πâ‡∏õ‡∏•‡πà‡∏≠‡∏¢ kernel ‡πÉ‡∏´‡∏°‡πà ‡∏£‡∏∏‡πà‡∏ô 6.6 lts  ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏°‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß update ‡∏´‡∏•‡∏±‡∏Å‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á build kernel ‡πÄ‡∏≠‡∏á‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ó‡∏≥‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

## ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ (‡πÉ‡∏ô Linux ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô Ubuntu 24.04)

```bash
sudo apt update
sudo apt install build-essential flex bison dwarves libssl-dev libelf-dev cpio
```
## Download kernel source

Download kernel source ‡∏à‡∏≤‡∏Å https://github.com/microsoft/WSL2-Linux-Kernel/releases

```bash
 wget https://github.com/microsoft/WSL2-Linux-Kernel/archive/refs/tags/linux-msft-wsl-6.6.36.3.tar.gz

 tar vxfz linux-msft-wsl-6.6.36.3.tar.gz
 cd WSL2-Linux-Kernel-linux-msft-wsl-6.6.36.3
 ```

## Compile

```bash
make -j$(nproc)  KCONFIG_CONFIG=Microsoft/config-wsl 
```

*-j ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô CPU ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ $(nproc) ‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏ñ‡πâ‡∏≤‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∑‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡πá‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏Å‡πá‡πÑ‡∏î‡πâ*

## Install kernel modules and headers

```
sudo make modules_install headers_install
```
*‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ module ‡πÅ‡∏•‡∏∞ header ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á linux image ‡πÑ‡∏õ‡∏ó‡∏µ‡πà /boot ‡∏î‡πâ‡∏ß‡∏¢*
## Copy kernel image to windows

```
mkdir /mnt/c/kernel
cp arch/x86/boot/bzImage /mnt/c/kernel
```

*‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á directory ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô Windows filesystem ‡∏à‡∏∞ C: ‡∏´‡∏£‡∏∑‡∏≠ D: ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏î ‡πÜ ‡∏Å‡πá‡πÑ‡∏î‡πâ*

## Edit .wslconfig

powershell
```powershell
notepad $env:USERPROFILE\.wslconfig
```

cmd
```cmd
notepad %USERPROFILE%\.wslconfig
```

linux (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£ ‡∏Æ‡∏≤)
```bash
nano -w $(wslpath  "$(powershell.exe Write-Host -NoNewLine '$env:USERPROFILE')")/.wslconfig
```

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ô Linux ‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏£‡∏π‡πâ path ‡∏Å‡πá‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏£‡∏á ‡πÜ ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô `/mnt/c/Users/mrchoke/.wslconfig`

‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡∏•‡∏á‡πÑ‡∏õ‡πÉ‡∏ô .wslconfig

```
kernel=C:\\kernel\\bzImage
```
*‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÉ‡∏ä‡πâ \\\\ ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà \\*

## Shutdown WSL

```powershell
wsl --shutdown
```

## ‡πÄ‡∏Ç‡πâ‡∏≤ WSL ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

```powershell
wsl
```

*‡∏ñ‡πâ‡∏≤ Error ‡∏Å‡πá‡πÉ‡∏´‡πâ Edit ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ñ‡πâ‡∏≤‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏≠‡∏≠‡∏Å*

## ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÉ‡∏ä‡πâ kernel ‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á

```

uname -a 
‡∏µ‡∏µuname -r

```

___
‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏Å‡∏±‡∏ö Linux ‡∏Ñ‡∏£‡∏±‡∏ö

‚ù§Ô∏èüêß